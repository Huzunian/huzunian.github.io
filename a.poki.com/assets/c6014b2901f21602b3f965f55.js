"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6014],{6014:(e,t,n)=>{n.r(t),n.d(t,{fixIOSFullscreen:()=>T,forwardPostMessageEpic:()=>z,fullscreenEpic:()=>C,gameBootEpic:()=>x,pubHostInitializedEpic:()=>A,receivePostMessageEpic:()=>q,setRecentGameEpic:()=>W,switchWorldToEpic:()=>L,updatePokiURLParams:()=>U,worldSwitchedToEpic:()=>O});var o=n(1545),i=n(2817),r=n(2401),l=n(3071),a=n(9635),s=n(4975),c=n(2006),u=n(9127),d=n(533),p=n(4978),w=n(6108),m=n(8966),g=n(5069),f=n(5982),h=n(8813),v=n(905),y=n(3748),E=n(4481),k=n(6151),_=n(7344),b=n(8855),F=n(8656),R=n(6619),S=n(9563),D=n(65),B=n(4927);const I=["localhost","games.poki.com","game-cdn.poki.com"],M={CrossyMultiverseMessage_worldSwitchedTo:v.VN,pubHostInitialized:v.B5,[S.cO]:v.OB,[S.xE]:v.aw,[S.A$]:v.PP,[S.Yn]:v.iq,SaveGameMigrator:!0};function q(e,t){return e.pipe((0,g.l)(v.y6.type),(0,s.h)((e=>{let{event:t}=e;if(!t.data.type||!M[t.data.type])return!1;const n=(0,E._Y)(t.origin),o=I.includes(n)||n.endsWith(".poki-gdn.com")||window.location.origin===t.origin,i=document.querySelector('iframe[name="gameFrame"]'),r=i&&i.src.startsWith(t.origin);return o||r})),(0,c.b)((e=>{let{event:{data:{content:t,type:n}}}=e;if(["pokiMessageEvent","pokiMessageDebug","SaveGameMigrator"].includes(n)&&((0,y.A)("sdk","message",{content:t,type:n}),window.parent!==window)){const e="production"===process.env.SERVICE_ENV;window.parent.postMessage({content:t,type:n},e?"devs.poki.io":"*")}})),(0,s.h)((e=>{var n,o;let{event:i}=e,r=null===(n=i.data.content)||void 0===n||null===(o=n.pokifordevs)||void 0===o?void 0:o.game_id;var l;r||(r=null===(l=i.data.content)||void 0===l?void 0:l.gameID);const a=(0,F.J1)(t.value);return!(!a||!r||r!=="".concat(a.pokifordevs_game_id))})),(0,s.h)((e=>{let{event:{data:{type:t}}}=e;return"function"==typeof M[t]})),(0,u.U)((e=>{let{event:{data:{content:t,type:n}}}=e;return M[n](t)})))}function L(e,t){return e.pipe((0,g.l)(v.Ot.type),(0,s.h)((()=>window.frames.gameFrame)),(0,s.h)((e=>{let{world:n}=e;return(0,b.Bs)(t.value)!==n})),(0,c.b)((e=>{window.frames.gameFrame.postMessage({type:"CrossyMultiverseMessage_switchWorldTo",content:{worldName:e}},"*")})),(0,u.U)((e=>(0,v.Bn)({world:e,gameId:(0,F.J1)(t.value).id}))))}function O(e,t){return e.pipe((0,g.l)(v.VN.type),(0,u.U)((e=>{let{worldName:t}=e;return t})),(0,s.h)((e=>(0,b.Bs)(t.value)!==e)),(0,u.U)((e=>(0,v.Bn)({world:e,gameId:(0,F.J1)(t.value).id}))))}function U(e){return e.pipe((0,g.l)(v.PP.type),(0,c.b)((e=>{const{params:t}=e;if(!t)return;const n=Object.keys(t),o=new URLSearchParams(window.location.search),i=[];o.forEach(((e,t)=>{t.startsWith("gd")&&i.push(t)})),i.forEach((e=>{o.delete(e)})),n.forEach((e=>{o.set("gd".concat(e),t[e])})),window.history.replaceState({},document.title,"".concat(window.location.pathname,"?").concat(o.toString()))})),(0,d.l)())}function x(e){return e.pipe((0,g.l)(v.Gq.type),(0,c.b)((()=>{(0,y.A)("game","boot"),(0,D.u)()})),(0,d.l)())}function A(e,t){return e.pipe((0,g.l)(v.B5.type),(0,p.w)((e=>{const n=(0,F.J1)(t.value);return n?((0,y.A)("pubHost","initialized",e),(0,i.of)((0,v.P8)({gameId:n.id,data:e}))):o.E})))}function z(){return window.removeEventListener("message",messageListener),(0,r.R)(window,"message").pipe((0,w.O)(...messageBuffer),(0,u.U)((e=>(0,v.y6)({event:e}))))}const P=()=>document.getElementById("game-container");function T(e,t){return e.pipe((0,g.l)(v.Gq.type),(0,c.b)((()=>{const e=(0,k.eD)(t.value);if("undefined"==typeof navigator||"undefined"==typeof window)return;const n=document.getElementById("game-element");if(!e||!n)return;(0,D.u)();const o=()=>{window.scrollTo(0,0),n.style.width="".concat(window.innerWidth,"px"),n.style.height="".concat(window.innerHeight,"px")};window.addEventListener("resize",o),o(),setTimeout((()=>{o()}),3e3)})),(0,d.l)())}const H=async(e,t)=>{if(!(0,k.At)(t)){try{e.requestFullscreen?await e.requestFullscreen({navigationUI:"hide"}):e.webkitRequestFullscreen?await e.webkitRequestFullscreen():e.mozRequestFullScreen?await e.mozRequestFullScreen():e.msRequestFullscreen&&await e.msRequestFullscreen()}catch(e){}e.focus()}const n=(0,F.J1)(t);if((0,k.eD)(t)&&n&&n.mobile_file&&n.mobile_file.orientation){const{orientation:e}=n.mobile_file;if(["portrait","landscape"].includes(e)&&window.screen)if(window.screen.orientation&&window.screen.orientation.lock)try{window.screen.orientation.lock(e)}catch(e){}else{const t=window.screen.lockOrientation||window.screen.mozLockOrientation||window.screen.msLockOrientation;t&&t(e)}}};function W(e,t){return e.pipe((0,g.l)(h.HI.type),(0,p.w)((e=>{let{data:n}=e;if("undefined"==typeof window)return o.E;if("game"!==(0,F.Wj)(t.value))return o.E;const r=(0,_.lH)(t.value),{id:l}=n.details;return(0,i.of)((0,h.FR)({id:l,siteID:r.id}))})))}function C(e,t){const n=e.pipe((0,g.l)(h.JV.type),(0,s.h)((()=>window.matchMedia("(display-mode: standalone)").matches)),(0,u.U)((()=>(0,v.Zx)({toggle:!0})))),w=(0,l.T)((0,r.R)(window,"fullscreenchange"),(0,r.R)(window,"webkitfullscreenchange"),(0,r.R)(window,"mozfullscreenchange"),(0,r.R)(window,"MSFullscreenChange")).pipe((0,p.w)((()=>{const e=["fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement"].some((e=>document[e]));return(0,R.k)(),(0,b.Eo)(t.value)!==!!e?(0,k.eD)(t.value)&&!e?o.E:(0,i.of)((0,v.K1)({toggle:e})):o.E}))),y=e.pipe((0,g.l)(v.Zx.type),(0,s.h)((e=>{let{toggle:t}=e;return t})),(0,p.w)((()=>{const e=P();return e?(0,a.D)(H(e,t.value)).pipe((0,u.U)((()=>(0,v.K1)({toggle:!0})))):o.E}))),E=e.pipe((0,g.l)(v.Zx.type),(0,s.h)((e=>{let{toggle:t}=e;return!t})),(0,p.w)((()=>{const e=["exitFullscreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"].find((e=>!!document[e]));if(e)try{document[e]()}catch(e){}return(0,i.of)((0,v.K1)({toggle:!1}))}))),_="fullscreen",F=(0,l.T)(e.pipe((0,g.l)(v.K1.type),(0,c.b)((e=>{let{toggle:t}=e;window.location.hash=t?_:""})),(0,d.l)()),e.pipe((0,g.l)(h.JV.type,f.nk,B.ZB.type),(0,p.w)((()=>{const e=window.location.hash==="#".concat(_),n=(0,b.dW)(t.value),r=(0,k.eD)(t.value);return(0,b.Eo)(t.value)!==e&&(n||r)?(0,i.of)((0,v.Zx)({toggle:e})):o.E})))),S=e.pipe((0,g.l)(v.Gq.type),(0,s.h)((e=>{let{el:n}=e;return(0,k.eD)(t.value)&&n})),(0,p.w)((e=>{let{el:n}=e;return(0,l.T)((0,r.R)(P(),"click"),(0,r.R)(n,"click")).pipe((0,s.h)((()=>(0,k.eD)(t.value))),(0,c.b)((()=>{const e=P();H(e,t.value)})),(0,m.R)(E),(0,d.l)())}))),D=e.pipe((0,g.l)(v.K1.type),(0,p.w)((e=>{let{toggle:t}=e;const n=document.getElementById("app-root");return n.style.overflow=t?"hidden":"auto",n.style.height=t?"100vh":"auto",o.E})));return(0,l.T)(y,n,E,w,F,S,D)}}}]);